( Find the thirteen adjacent digits in the 1000-digit number that have the greatest product. What is the value of this product? )

: map2 dupnil== if drop r> drop else 
       car r@ call >r swap r> swap cons swap recurse call then ;
: map >r nil swap map2 call reverse ; ( List Function -- List )

: product2 dup integer 0 == if drop drop r> else
    swap dup integer 10 rem r> * >r integer 10 / swap integer 1 - recurse call
then ;
macro product integer 1 >r product2 call ;

macro abs dup integer 0 < if integer -1 * else then ;
macro max 2dup - abs tuck + + integer 2 / ;

: max_product dup integer 0 == if drop r> else
 dup Scale @ product r> max >r integer 10 / recurse call 
then;
: max_product0 integer 0 >r max_product call ;
: max_list0 dupnil== if drop r> else
car r> max >r recurse call then;
macro max_list integer 0 >r max_list0 call ;

( integer 222233 max_product0 )
integer 13 Scale !
[
integer 731671765313306249192251196744265747423553491949349698352031,
integer 534919493496983520312774506326239578318016984801869478851843,
integer 169848018694788518438586156078911294949545950173795833195285,
integer 459501737958331952853208805511125406987471585238630507156932,
integer 715852386305071569329096329522744304355766896648950445244523,
integer 668966489504452445231617318564030987111217223831136222989342,
integer 172238311362229893423380308135336276614282806444486645238749,
integer 828064444866452387493035890729629049156044077239071381051585,
integer 440772390713810515859307960866701724271218839987979087922749,
integer 188399879790879227492190169972088809377665727333001053367881,
integer 657273330010533678812202354218097512545405947522435258490771,
integer 059475224352584907711670556013604839586446706324415722155397,
integer 467063244157221553975369781797784617406495514929086256932197,
integer 955149290862569321978468622482839722413756570560574902614079,
integer 565705605749026140797296865241453510047482166370484403199890,
integer 821663704844031998900088952434506585412275886668811642717147,
integer 758866688116427171479924442928230863465674813919123162824586,
integer 748139191231628245861786645835912456652947654568284891288314,
integer 476545682848912883142607690042242190226710556263211111093705,
integer 105562632111110937054421750694165896040807198403850962455444,
integer 071984038509624554443629812309878799272442849091888458015616,
integer 428490918884580156166097919133875499200524063689912560717606,
integer 240636899125607176060588611646710940507754100225698315520005,
integer 541002256983155200055935729725716362695618826704282524836008,
integer 1882670428252483600823257530420752963450
]

max_product0 map call
max_list